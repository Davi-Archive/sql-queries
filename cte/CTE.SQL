WITH cte AS (
SELECT
	PRODUCTKEY,
	PRODUCTNAME,
	BRANDNAME,
	COLORNAME,
	UNITPRICE
FROM
	DimProduct
WHERE BrandName = 'CONTOSO'
)

SELECT COUNT(*) FROM cte
----
-----
WITH cte AS (
SELECT BRANDNAME,
COUNT(*) AS 'TOTAL'
FROM DimProduct
GROUP BY BrandName
)

SELECT AVG(TOTAL) FROM cte
---
---
WITH CTE(MARCA,TOTAL) AS (
SELECT
BRANDNAME,
COUNT(*)
FROM DimProduct
GROUP BY BrandName
)

SELECT
MARCA,
TOTAL
FROM
CTE
-----
-----
WITH PRODUTOS_CONTOSO AS (
SELECT
	PRODUCTKEY,
	PRODUCTNAME,
	BRANDNAME
FROM
	DimProduct
WHERE BrandName = 'CONTOSO'),
VENDAS_TOP100 AS (
SELECT TOP (100)
SALESKEY,
PRODUCTKEY,
DATEKEY,
SALESQUANTITY
FROM
FactSales
ORDER BY DateKey DESC
)

SELECT * FROM VENDAS_TOP100
INNER JOIN PRODUTOS_CONTOSO
ON VENDAS_TOP100.PRODUCTKEY = PRODUTOS_CONTOSO.PRODUCTKEY