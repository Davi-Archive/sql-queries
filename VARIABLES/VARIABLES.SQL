SELECT SQL_VARIANT_PROPERTY(10,'BASETYPE')
--

SELECT CAST('2021-06-21' as datetime)
--
SELECT 'O PREÇO DO PASTEL É ' + CAST(30.99 AS VARCHAR)
--
SELECT CAST('2021-06-21' as datetime)+1
--
SELECT FORMAT(1000,'G')
SELECT FORMAT(1000,'N')
--
SELECT FORMAT(123456789,'###-###-####')
--

SELECT FORMAT(CAST('2021-03-21' AS datetime),'dd/MM/yyyy')
--

SELECT FORMAT(CAST('2021-03-21' AS datetime),'MMMM')
--
select round(12.13945,2)
select round(12.13945,2,1)
--
DECLARE @IDADE INT
SET @IDADE = 30

SELECT @IDADE
--
DECLARE @DESCONTO FLOAT
SET @DESCONTO = (1-0.10)

SELECT
ProductKey,
ProductName,
UnitPrice,
UnitPrice * @DESCONTO AS 'DESCONTO'
FROM DimProduct
--
DECLARE @VARLOJASOFF INT
SET @VARLOJASOFF =
(SELECT COUNT(*) FROM DimStore WHERE Status='OFF')
SELECT @VARLOJASOFF
--
SET NOCOUNT ON

DECLARE @VARLOJASON INT, @VARLOJASOFF INT
SET @VARLOJASON = (SELECT COUNT(*)
FROM dimStore WHERE Status= 'ON')
SET @VARLOJASOFF = (SELECT COUNT(*)
FROM DimStore WHERE Status= 'OFF')

SELECT @VARLOJASON AS 'LOJAS ABERTAS',
@VARLOJASOFF AS 'LOJAS FECHADAS'

PRINT 'TOTAL DE LOJAS ABERTAS' +
CAST(@VARLOJASOFF AS VARCHAR(30))
PRINT 'TOTAL DE LOJAS FECHADAS' +
CAST(@VARLOJASON AS VARCHAR(30))

--
DECLARE @PRODUTOMAISVENDIDO INT
DECLARE @VARTOTALMAISVENDIDO INT

SELECT TOP(1)
@PRODUTOMAISVENDIDO = PRODUCTKEY,
@VARTOTALMAISVENDIDO = SALESQUANTITY
FROM
FactSales
ORDER BY SalesQuantity DESC

PRINT @VARTOTALMAISVENDIDO
PRINT @PRODUTOMAISVENDIDO

SELECT
 ProductKey,
 PRODUCTNAME
 FROM DimProduct
 WHERE ProductKey = @VARTOTALMAISVENDIDO
 --
 DECLARE @VARLISTANOMES VARCHAR(50)
set @VARLISTANOMES = ''

SELECT @VARLISTANOMES = @VARLISTANOMES + FIRSTNAME+' ,'
FROM DimEmployee
WHERE DepartmentName = 'MARKETING' AND GENDER = 'F'

PRINT @VARLISTANOMES